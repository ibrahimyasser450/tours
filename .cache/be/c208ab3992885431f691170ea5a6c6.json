{"id":"../../utils/apiFeatures.js","dependencies":[{"name":"C:\\Users\\Dell\\Downloads\\4-natours\\package.json","includedInParent":true,"mtime":1738438436952}],"generated":{"js":"function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _classCallCheck(a, n) { if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\"); }\nfunction _defineProperties(e, r) { for (var t = 0; t < r.length; t++) { var o = r[t]; o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, _toPropertyKey(o.key), o); } }\nfunction _createClass(e, r, t) { return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", { writable: !1 }), e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar APIFeatures = /*#__PURE__*/function () {\n  function APIFeatures(query, queryString) {\n    _classCallCheck(this, APIFeatures);\n    this.query = query;\n    this.queryString = queryString;\n  }\n  return _createClass(APIFeatures, [{\n    key: \"filter\",\n    value: function filter() {\n      var queryObj = _objectSpread({}, this.queryString); // put the copy of req.query in new object.\n      var excludedFields = ['page', 'sort', 'limit', 'fields'];\n      excludedFields.forEach(function (el) {\n        return delete queryObj[el];\n      });\n      var queryStr = JSON.stringify(queryObj); // convert object to string\n      queryStr = queryStr.replace(/\\b(gte|gt|lte|lt)\\b/g, function (match) {\n        return \"$\".concat(match);\n      }); // /g global if there two or three operators, then it will replace all of them, /b case sensitive\n      this.query = this.query.find(JSON.parse(queryStr)); // convert string to object\n\n      return this;\n    }\n  }, {\n    key: \"sort\",\n    value: function sort() {\n      if (this.queryString.sort) {\n        var sortBy = this.queryString.sort.split(',').join(' '); // 'sort=price,ratingsAverage' => 'price ratingsAverage'\n        this.query = this.query.sort(sortBy);\n      } else {\n        this.query = this.query.sort('-createdAt'); // default sort by createdAt in descending order meaning newest first\n      }\n      return this;\n    }\n  }, {\n    key: \"limitFields\",\n    value: function limitFields() {\n      if (this.queryString.fields) {\n        var fields = this.queryString.fields.split(',').join(' ');\n        this.query = this.query.select(fields);\n      } else {\n        this.query = this.query.select('-__v'); // exclude __v field meaning select all fields except __v\n      }\n      return this;\n    }\n  }, {\n    key: \"paginate\",\n    value: function paginate() {\n      // to know how many results we have at each page and at specific page\n      var page = this.queryString.page * 1 || 1; // if page is not exist, then default value is page = 1, we do * 1 to convert string to number\n      var limit = this.queryString.limit * 1 || 100; // if limit is not exist, then default value is limit = 100\n      var skip = (page - 1) * limit;\n\n      // page=2&limit=10 => page 2 have 10 results 11-20\n      // page=3&limit=3 => page 3 have 3 results 7-9\n      this.query = this.query.sort(this.queryString.sort || '_id');\n      this.query = this.query.skip(skip).limit(limit);\n      return this;\n    }\n  }]);\n}();\nmodule.exports = APIFeatures;"},"sourceMaps":null,"error":null,"hash":"8d38ed842743fd4384b6722649b037f5","cacheData":{"env":{}}}