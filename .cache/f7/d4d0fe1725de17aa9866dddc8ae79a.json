{"id":"../../node_modules/parse-asn1/index.js","dependencies":[{"name":"C:\\Users\\Dell\\Downloads\\4-natours\\package.json","includedInParent":true,"mtime":1738438436952},{"name":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\package.json","includedInParent":true,"mtime":1737568454108},{"name":"./asn1","loc":{"line":3,"column":19,"index":34},"parent":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\index.js","resolved":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\asn1.js"},{"name":"./aesid.json","loc":{"line":4,"column":20,"index":65},"parent":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\index.js","resolved":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\aesid.json"},{"name":"./fixProc","loc":{"line":5,"column":22,"index":104},"parent":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\index.js","resolved":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\fixProc.js"},{"name":"browserify-aes","loc":{"line":6,"column":22,"index":140},"parent":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\index.js","resolved":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\browserify-aes\\browser.js"},{"name":"pbkdf2","loc":{"line":7,"column":21,"index":180},"parent":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\index.js","resolved":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\pbkdf2\\browser.js"},{"name":"safe-buffer","loc":{"line":8,"column":21,"index":212},"parent":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\parse-asn1\\index.js","resolved":"C:\\Users\\Dell\\Downloads\\4-natours\\node_modules\\safe-buffer\\index.js"}],"generated":{"js":"\n'use strict';\n\nvar asn1 = require('./asn1');\nvar aesid = require('./aesid.json');\nvar fixProc = require('./fixProc');\nvar ciphers = require('browserify-aes');\nvar compat = require('pbkdf2');\nvar Buffer = require('safe-buffer').Buffer;\nfunction decrypt(data, password) {\n  var salt = data.algorithm.decrypt.kde.kdeparams.salt;\n  var iters = parseInt(data.algorithm.decrypt.kde.kdeparams.iters.toString(), 10);\n  var algo = aesid[data.algorithm.decrypt.cipher.algo.join('.')];\n  var iv = data.algorithm.decrypt.cipher.iv;\n  var cipherText = data.subjectPrivateKey;\n  var keylen = parseInt(algo.split('-')[1], 10) / 8;\n  var key = compat.pbkdf2Sync(password, salt, iters, keylen, 'sha1');\n  var cipher = ciphers.createDecipheriv(algo, key, iv);\n  var out = [];\n  out.push(cipher.update(cipherText));\n  out.push(cipher['final']());\n  return Buffer.concat(out);\n}\nfunction parseKeys(buffer) {\n  var password;\n  if (typeof buffer === 'object' && !Buffer.isBuffer(buffer)) {\n    password = buffer.passphrase;\n    buffer = buffer.key;\n  }\n  if (typeof buffer === 'string') {\n    buffer = Buffer.from(buffer);\n  }\n  var stripped = fixProc(buffer, password);\n  var type = stripped.tag;\n  var data = stripped.data;\n  var subtype, ndata;\n  switch (type) {\n    case 'CERTIFICATE':\n      ndata = asn1.certificate.decode(data, 'der').tbsCertificate.subjectPublicKeyInfo;\n    // falls through\n    case 'PUBLIC KEY':\n      if (!ndata) {\n        ndata = asn1.PublicKey.decode(data, 'der');\n      }\n      subtype = ndata.algorithm.algorithm.join('.');\n      switch (subtype) {\n        case '1.2.840.113549.1.1.1':\n          return asn1.RSAPublicKey.decode(ndata.subjectPublicKey.data, 'der');\n        case '1.2.840.10045.2.1':\n          ndata.subjectPrivateKey = ndata.subjectPublicKey;\n          return {\n            type: 'ec',\n            data: ndata\n          };\n        case '1.2.840.10040.4.1':\n          ndata.algorithm.params.pub_key = asn1.DSAparam.decode(ndata.subjectPublicKey.data, 'der');\n          return {\n            type: 'dsa',\n            data: ndata.algorithm.params\n          };\n        default:\n          throw new Error('unknown key id ' + subtype);\n      }\n    // throw new Error('unknown key type ' + type)\n    case 'ENCRYPTED PRIVATE KEY':\n      data = asn1.EncryptedPrivateKey.decode(data, 'der');\n      data = decrypt(data, password);\n    // falls through\n    case 'PRIVATE KEY':\n      ndata = asn1.PrivateKey.decode(data, 'der');\n      subtype = ndata.algorithm.algorithm.join('.');\n      switch (subtype) {\n        case '1.2.840.113549.1.1.1':\n          return asn1.RSAPrivateKey.decode(ndata.subjectPrivateKey, 'der');\n        case '1.2.840.10045.2.1':\n          return {\n            curve: ndata.algorithm.curve,\n            privateKey: asn1.ECPrivateKey.decode(ndata.subjectPrivateKey, 'der').privateKey\n          };\n        case '1.2.840.10040.4.1':\n          ndata.algorithm.params.priv_key = asn1.DSAparam.decode(ndata.subjectPrivateKey, 'der');\n          return {\n            type: 'dsa',\n            params: ndata.algorithm.params\n          };\n        default:\n          throw new Error('unknown key id ' + subtype);\n      }\n    // throw new Error('unknown key type ' + type)\n    case 'RSA PUBLIC KEY':\n      return asn1.RSAPublicKey.decode(data, 'der');\n    case 'RSA PRIVATE KEY':\n      return asn1.RSAPrivateKey.decode(data, 'der');\n    case 'DSA PRIVATE KEY':\n      return {\n        type: 'dsa',\n        params: asn1.DSAPrivateKey.decode(data, 'der')\n      };\n    case 'EC PRIVATE KEY':\n      data = asn1.ECPrivateKey.decode(data, 'der');\n      return {\n        curve: data.parameters.value,\n        privateKey: data.privateKey\n      };\n    default:\n      throw new Error('unknown key type ' + type);\n  }\n}\nparseKeys.signature = asn1.signature;\nmodule.exports = parseKeys;"},"sourceMaps":null,"error":null,"hash":"5afa55c5929e3c6acf4fb78ef094a7ce","cacheData":{"env":{}}}